{{- 'section-hero.css' | asset_url | stylesheet_tag -}}

{% assign _blocks = section.blocks %}

{% if _blocks != blank %}
  <hero-slider class="hero" data-arrows="{% if _blocks.size > 1 %}true{% else %}false{% endif %}">
    <div class="splide js-slider">
      <div class="splide__track">
        <ul class="splide__list">
          {% for block in _blocks %}
            {% assign _block = block.settings %}
            
            <li class="splide__slide">
              <div class="hero__image">
                {% if _block.image != blank %}
                  {%- assign image = _block.image -%}

                  {{ image | image_url: width: image.width | image_tag: class: 'add_your_class_here', loading: 'lazy' }}
                {% else %}
                  {{ 'image' | placeholder_svg_tag: 'placeholder-svg' }}
                {% endif %}
              </div><!-- /.hero__image -->
    
              {% if _block.sub_heading != blank or _block.heading != blank or _blocks.text != blank %}
                <div class="page-width">
                  <div class="hero__content">
                    {% if _block.sub_heading != blank %}
                      <h3>{{ _block.sub_heading }}</h3>
                    {% endif %}

                    {% if _block.heading != blank %}
                      <h2>{{ _block.heading }}</h2>
                    {% endif %}

                    {% if _block.text != blank %}
                      <div class="hero__entry">
                        <p>{{ _block.text }}</p>
                      </div><!-- /.hero__entry -->
                    {% endif %}
                  </div><!-- /.hero__content -->
                </div><!-- /.page-width -->
              {% endif %}
            </li>
          {% endfor %}
        </ul>
      </div>

      <div class="splide__arrows"></div>
    </div>
  </hero-slider>
{% endif %}


{% schema %}
{
  "name": "Hero",
  "settings": [],
  "blocks": [
    {
      "name": "Slide",
      "type": "slide",
      "settings": [
        {
          "type": "image_picker",
          "id": "image",
          "label": "Image"
        },
        {
          "type": "text",
          "id": "sub_heading",
          "label": "Sub Heading",
          "default": "Sub Heading"
        },
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Heading"
        },
        {
          "type": "textarea",
          "id": "text",
          "label": "Text",
          "default": "Text"
        },
        {
          "type": "header",
          "content": "Button"
        },
        {
          "type": "text",
          "id": "button_text",
          "label": "Text",
          "default": "Button Text"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Link"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Hero"
    }
  ]
}
{% endschema %}

{% javascript %}
  (() => {
    if (customElements.get('hero-slider')) {
      return;
    }

    class HeroSlider extends HTMLElement {
      constructor() {
        super();
        this.slider = null;
        this.arrows = this.dataset.arrows;
        this.options = {
          waitForTransition: false,
          perPage: 1,
          gap: 20,
          pagination: false,
          arrows: false
        };

        if (this.arrows == 'true') {
          this.options.arrows = true;
          this.options.pagination = true;
        }
      }

      connectedCallback() {
        this.initSlider();
      }

      initSlider() {
        if (!this.querySelector('.js-slider')) return;

        this.slider = new Splide(
          this.querySelector('.js-slider'),
          this.options
        ).mount();
      }
    }

    customElements.define('hero-slider', HeroSlider);
  })();
{% endjavascript %}